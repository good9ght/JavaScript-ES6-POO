{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["Negociacao","NegociacaoService","NegociacaoDao","ListaNegociacoes","NegociacoesView","Mensagem","MensagemView","Bind","DateHelper","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_ordemAtual","_listaNegociacoes","_mensagem","_service","_init","listar","then","negociacoes","forEach","adicionar","negociacao","catch","texto","erro","setInterval","importar","evento","preventDefault","_criarNegociacao","cadastra","mensagem","_limparCampos","textoParaData","value","apagar","esvaziar","coluna","inverterOrdem","ordenar","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { Negociacao } from '../models/Negociacao';\nimport { NegociacaoService } from '../services/NegociacaoService';\nimport { NegociacaoDao } from '../dao/NegociacaoDao';\nimport { ListaNegociacoes } from '../models/ListaNegociacoes';\nimport { NegociacoesView } from '../views/NegociacoesView';\nimport { Mensagem } from '../models/Mensagem';\nimport { MensagemView } from '../views/MensagemView';\nimport { Bind } from '../helpers/Bind';\nimport { DateHelper } from '../helpers/DateHelper';\n\nclass NegociacaoController {\n\n    constructor() {\n        /*\n        |----------------------------------------------------------------------\n        | bind()\n        |----------------------------------------------------------------------\n        |\n        | O querySelector é um método pertencente ao objeto document, ou seja,\n        | dentro dele, é utilizado o 'this' para se referir ao document.\n        | Ao ser colocado em uma variável ele perderá o contexto do objeto,\n        | deixará de ser um método e passará a ser uma função.\n        | O método bind(objeto) adiciona o contexto do objeto à função.\n        |\n        */\n        let $ = document.querySelector.bind(document);\n\n        /*\n        |----------------------------------------------------------------------\n        | Evitando percorrer o DOM muitas vezes\n        |----------------------------------------------------------------------\n        |\n        | Definir no construtor as variáveis que recebem elementos do DOM\n        | evita que o mesmo seja percorrido toda vez que uma função for chamada.\n        |\n        */\n        this._inputData = $(\"#data\");\n        this._inputQuantidade = $(\"#quantidade\");\n        this._inputValor = $(\"#valor\");\n\n        this._ordemAtual = '';\n\n        this._listaNegociacoes = new Bind(\n            new ListaNegociacoes(),\n            new NegociacoesView($(\"#negociacoesView\")),\n            \"adicionar\", \"esvaziar\", \"ordenar\", \"inverterOrdem\"\n        );\n\n        this._mensagem = new Bind(\n            new Mensagem(),\n            new MensagemView($(\"#mensagemView\")),\n            \"texto\"\n        );\n\n        this._service = new NegociacaoService();\n\n        this._init();\n    }\n\n    _init() {\n        /*\n        |----------------------------------------------------------------------\n        | Promises\n        |----------------------------------------------------------------------\n        |\n        | Se o then() retorna algo é possivel adicionar outro then() que receberá\n        | o seu retorno.\n        |\n        */\n        this._service\n            .listar()\n            .then(negociacoes => negociacoes.forEach(negociacao =>\n                this._listaNegociacoes.adicionar(negociacao)))\n            .catch(erro => this._mensagem.texto = erro);\n\n        setInterval(() => this.importar(), 3000);\n    }\n\n    adicionar(evento) {\n        evento.preventDefault();\n\n        let negociacao = this._criarNegociacao();\n\n        this._service\n        .cadastra(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adicionar(negociacao);\n                this._mensagem.texto = mensagem;\n                this._limparCampos();\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    _criarNegociacao() {\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            this._inputQuantidade.value,\n            this._inputValor.value\n        );\n    }\n\n    _limparCampos() {\n        this._inputData.value = \"\";\n        this._inputQuantidade.value = 1;\n        this._inputValor.value = 0;\n    }\n\n    apagar() {\n        this._service\n            .apagar()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvaziar();\n            })\n            .catch(erro => {\n                this._mensagem.texto = erro;\n            });\n    }\n\n    importar() {\n        this._service\n            .importar(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => {\n                negociacoes.forEach(negociacao =>\n                this._listaNegociacoes.adicionar(negociacao));\n                this._mensagem.texto = \"Negociações Importadas.\";\n            })\n            .catch(erro => this._mensagem.texto = erro)\n    }\n\n    ordenar(coluna) {\n        if(this._ordemAtual == coluna) {\n            this._listaNegociacoes.inverterOrdem();\n        }\n        else {\n            this._listaNegociacoes.ordenar((a, b) => a[coluna] - b[coluna]);\n            this._ordemAtual = coluna;\n        }\n    }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\n    return negociacaoController;\n\n}\n"]}